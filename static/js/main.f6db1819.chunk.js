(this["webpackJsonpsubstitute-variations"]=this["webpackJsonpsubstitute-variations"]||[]).push([[0],{41:function(t,e,n){},61:function(t,e,n){"use strict";n.r(e);var r=n(3),a=n.n(r),c=n(8),i=n(0),o=n.n(i),s=n(29),l=n.n(s),u=(n(40),n(41),n(14)),f=n(7),d=n(6),p=n(2);function j(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.reduce((function(t,e){return e(t)}),t)}var h=function(t){return t.trim().split("\n").map((function(t){return t.trim()}))},b=function(t){return t.join("").replace(/ +/g," ").replace(/ ([.,?!;:])/g,"$1").trim()},v=/\[([^\]]+)\]/,m=function(t){return Object(p.a)(new Set(t))},O=function(t){var e=t.split(v).reduce((function(t,e,n){return n%2===0?t.map((function(t){return[].concat(Object(p.a)(t),[e])})):j(t,(r=e.split("/"),function(t){return r.flatMap((function(e){return t.map((function(t){return[].concat(Object(p.a)(t),[e])}))}))}));var r}),[[""]]).map(b);return m(e)},x=function(t){return h(t).flatMap((function(t){return m(O(t))}))},w=function(t){var e,n=h(t).map((function(t){return t.split(v).map((function(t,e){return e%2?t.split("/"):t}))})),r=[],a=Object(d.a)(n);try{var c=function(){var t=e.value,n=Math.max.apply(Math,[1].concat(Object(p.a)(t.filter((function(t,e){return e%2})).map((function(t){return t.length})))));r.push(Object(p.a)(new Array(n)).map((function(t,e){return e})).map((function(e){return t.map((function(t,n){return n%2?t[e%t.length]:t}))})).map(b))};for(a.s();!(e=a.n()).done;)c()}catch(i){a.e(i)}finally{a.f()}return m(r.flat())};var g,y,S,C,N,k,R,I,A,E,L=new Proxy({},{get:function(t,e){var n=new URL(window.location.href).searchParams.get(e);return null==n?void 0:JSON.parse(n)},set:function(t,e,n){var r=new URL(window.location.href);return r.searchParams.set(e,JSON.stringify(n)),window.history.replaceState({},document.title,r.href),!0},deleteProperty:function(t,e){var n=new URL(window.location.href);return n.searchParams.delete(e),window.history.replaceState({},document.title,n.href),!0}}),M=n(1),P="[Turn on/Switch on/Enable/Activate] [the/] driver['s seat/] fan [mode/].\n[Turn/Switch] [the/] driver['s seat/] fan on.",T=function(){var t,e,n=Object(i.useState)(null!==(t=null!==(e=L.input)&&void 0!==e?e:localStorage.previewInput)&&void 0!==t?t:P),r=Object(f.a)(n,2),a=r[0],c=r[1];Object(i.useEffect)((function(){a===P?(delete L.input,delete localStorage.previewInput):L.input=localStorage.previewInput=a}),[a]);var o=Object(i.useMemo)((function(){return[x(a),w(a)].map((function(t){return t.join("\n")}))}),[a]),s=Object(f.a)(o,2),l=s[0],u=s[1];return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("div",{children:[Object(M.jsx)("h1",{children:"Preview"}),Object(M.jsx)("textarea",{className:"spaced",rows:5,cols:70,value:a,onChange:function(t){var e=t.currentTarget.value;c(e)}}),Object(M.jsx)("button",{className:"button primary",onClick:function(){window.confirm("Reset input to default example?")&&c(P)},children:"Reset"})]}),Object(M.jsxs)("div",{children:[Object(M.jsx)("h2",{children:"Sample variations"}),Object(M.jsx)("div",{className:"pre-wrap",children:u})]}),Object(M.jsxs)("div",{children:[Object(M.jsx)("h2",{children:"Full list"}),Object(M.jsx)("div",{className:"pre-wrap",children:l})]})]})},U=n(4),F=n(34),J=n(30),W=n.n(J),B=n(13),_=n(12),$=function(){var t=Object(_.regex)(g||(g=Object(B.a)(["\n\t\t[^\n\t\t\t:\\/?*[]    # disallowed\n\t\t\t\0-\x1f\x7f # control chars\n\t\t\t'!:,          # delimiters\n\t\t]\n\t"],["\n\t\t[^\n\t\t\t:\\\\/?*\\[\\]    # disallowed\n\t\t\t\\x00-\\x1f\\x7f # control chars\n\t\t\t'!:,          # delimiters\n\t\t]\n\t"]))),e=Object(_.regex)(y||(y=Object(B.a)(["'","+'"])),t),n=Object(_.regex)(S||(S=Object(B.a)(["\n\t\t","+\n\t\t| ","\n\t"])),t,e),r=Object(_.regex)(C||(C=Object(B.a)(["[a-zA-Z]+"]))),a=Object(_.regex)(N||(N=Object(B.a)(["d+"],["\\d+"]))),c=Object(_.regex)(k||(k=Object(B.a)(["\n\t\t(?:",")\n\t\t(?:",")\n\t"])),r,a),i=Object(_.regex)(R||(R=Object(B.a)(["\n\t\t^\n\t\t\t(?<col>",")\n\t\t\t(?<row>",")?\n\t\t$\n\t"])),r,a),o=Object(_.regex)(I||(I=Object(B.a)(["\n\t\t^\n\t\t\t(?:",":",")\n\t\t\t| (?:",":",")\n\t\t$\n\t"])),c,c,r,r);return{cellRefStandalone:i,rangeRefStandalone:Object(_.regex)(A||(A=Object(B.a)(["\n\t\t(?:\n\t\t\t(?<sheet>",")\n\t\t\t!\n\t\t)?\n\t\t(?<cells>\n\t\t\t","\n\t\t)\n\t"])),n,Object(_.unwrap)(o)),rangeRefCellsOnly:o,escapedSheetRef:e}}(),q=function(t){var e,n,r=null!==(e=null===(n=t.match($.cellRefStandalone))||void 0===n?void 0:n.groups)&&void 0!==e?e:{},a=r.col,c=r.row;if(!a)throw new Error("Invalid cell reference");return[a,c?Number(c):-1]},D=function(t,e){if(!$.rangeRefCellsOnly.test(e))throw new Error("Invalid range");var n=e.split(":",2),r=Object(f.a)(n,2),a=[r[0],r[1]].map(q),c=Object(f.a)(a,2),i=Object(f.a)(c[0],2),o=i[0],s=i[1],l=Object(f.a)(c[1],2),u=l[0],d=l[1];if(s*d<0)throw new Error("Invalid range");var p=t.getColumn(u),j=t.getColumn(o);if(!p)throw new Error("End column not found");if(!j)throw new Error("Start column not found");var h=p.number,b=j.number,v=[];if(-1===s)for(var m=b;m<=h;m++)t.getColumn(m).eachCell((function(t,e){var n,r;null!==(r=v[n=e-1])&&void 0!==r||(v[n]=[]),v[e-1].push(t)}));else for(var O=s;O<=d;O++){var x=t.getRow(O);v.push([]);for(var w=b;w<=h;w++)v[v.length-1].push(x.getCell(w))}return v},V=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:",",r=[];return e.split(n).map((function(t){return t.trim()})).forEach((function(e){var n,a,c=null!==(n=null===(a=e.match($.rangeRefStandalone))||void 0===a?void 0:a.groups)&&void 0!==n?n:{},i=c.sheet,o=c.cells;if(i){var s=t.getWorksheet($.escapedSheetRef.test(i)?i.slice(1,-1):i);s&&r.push(D(s,o))}else t.eachSheet((function(t){return r.push(D(t,o))}))})),r},X=function(t){return new Promise((function(e){var n=new FileReader;n.onload=function(t){return e(t.target.result)},n.readAsArrayBuffer(t)}))},Z=function(t,e,n){var r=new Blob([e],{type:n}),a=document.createElement("a");a.href=window.URL.createObjectURL(r);var c=t;a.download=c,a.click()},z=["full","samples"],H={expansionType:"full",ranges:"*"},G=function(){var t=Object(i.useMemo)((function(){var t;return null!==(t=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.reduce((function(t,e){return null==t?t:e(t)}),t)}(localStorage.getItem("convertForm"),JSON.parse))&&void 0!==t?t:H}),[]),e=Object(F.a)({defaultValues:t}),n=e.register,r=e.handleSubmit,o=Object(i.useCallback)((function(t){localStorage.setItem("convertForm",JSON.stringify(t,(function(t,e){return"files"===t?void 0:e})))}),[]),s=Object(i.useCallback)(function(){var t=Object(c.a)(a.a.mark((function t(e){var n,r,c,i,o,s,l,u,f,p,j,h;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.files,r=e.expansionType,c="samples"===r?w:x,null===n||void 0===n?void 0:n.length){t.next=5;break}return window.alert("No file selected"),t.abrupt("return");case 5:return i=n[0],t.next=8,X(i);case 8:return o=t.sent,s=new W.a.Workbook,t.next=12,s.xlsx.load(o);case 12:if("*"!==(l=e.ranges.trim())){t.next=17;break}s.eachSheet((function(t){t.eachRow((function(t){t.eachCell((function(t){"string"===typeof t.value&&(t.value=c(t.value).join("\n"))}))}))})),t.next=27;break;case 17:t.prev=17,u=Object(d.a)(V(s,l,/[,\n]/).flat(2));try{for(u.s();!(f=u.n()).done;)"string"===typeof(p=f.value).value&&(p.value=c(p.value).join("\n"))}catch(b){u.e(b)}finally{u.f()}t.next=27;break;case 22:return t.prev=22,t.t0=t.catch(17),window.alert("Invalid ranges"),console.error(t.t0),t.abrupt("return");case 27:return t.next=29,s.xlsx.writeBuffer();case 29:j=t.sent,h=["".concat(i.name.split(".").slice(0,-1).join(".")),"expanded",r,(a=new Date,a.toISOString().replace(/:/g,"_").slice(0,19)+"Z")].join("_"),Z("".concat(h,".xlsx"),j,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");case 32:case"end":return t.stop()}var a}),t,null,[[17,22]])})));return function(e){return t.apply(this,arguments)}}(),[]);return Object(M.jsxs)("form",{onSubmit:r(s),onChange:r(o),children:[Object(M.jsx)("h1",{children:"Convert"}),Object(M.jsx)("div",{className:"spaced",children:Object(M.jsxs)("label",{children:["Upload file (XLSX)",Object(M.jsx)("input",{type:"file",name:"files",ref:n})]})}),Object(M.jsx)("div",{className:"spaced",children:Object(M.jsxs)("label",{children:["Expansion type",Object(M.jsx)("select",{name:"expansionType",ref:n,children:z.map((function(t){return Object(M.jsx)("option",{value:t,children:t},t)}))})]})}),Object(M.jsx)("div",{className:"spaced",children:Object(M.jsxs)("label",{children:["Ranges to include (* = all; comma/newline delimited)",Object(M.jsx)("textarea",{name:"ranges",ref:n})]})}),Object(M.jsx)("div",{className:"spaced",children:Object(M.jsx)("button",{type:"submit",children:"Convert"})})]})},K=n.p+"static/media/instructions.91848c3b.md",Q=function(t){var e,n,r=(e=0,new Proxy({},{get:function(t,n){return t.hasOwnProperty(n)?t[n]:e}})),a=Object(d.a)(t.querySelectorAll("h2, h3, h4, h5, h6, .anchored"));try{for(a.s();!(n=a.n()).done;){var c=n.value;if(c.textContent){var i=c.textContent.toLowerCase().replace(Object(_.regex)("gu")(E||(E=Object(B.a)(["[\n\t\t\t\t^\n\t\t\t\tp{Letter}\n\t\t\t\tp{Mark}\n\t\t\t\tp{Number}\n\t\t\t]+"],["[\n\t\t\t\t^\n\t\t\t\t\\p{Letter}\n\t\t\t\t\\p{Mark}\n\t\t\t\t\\p{Number}\n\t\t\t]+"])))," ").trim().replace(/\s+/g,"-")||"heading",o=++r[i];c.id=[i,o>1&&o].filter(Boolean).join("-"),c.classList.add("anchored")}}}catch(s){a.e(s)}finally{a.f()}},Y=n(22),tt=function(){var t,e=Object(i.useState)(""),n=Object(f.a)(e,2),r=n[0],o=n[1],s=Object(U.f)();return Object(i.useEffect)((function(){fetch(K,{cache:"force-cache"}).then(function(){var t=Object(c.a)(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.text();case 2:n=t.sent,r=n.split(/((?<=^|\n)```\r?\n[\s\S]*?\r?\n```)/).map((function(t,e){return e%2?"<pre><code>".concat(t.split(/\r?\n/).slice(1,-1).join("\n"),"</pre></code>"):t.split(/(?:\r?\n){2,}/).map((function(t){return[" ","\t","#","-","*","`","~"].some((function(e){return t.startsWith(e)}))?/^\s*-{3,}\s*$/.test(t)?"<hr>":Object(Y.a)(t):"<p>".concat(Object(Y.a)(t),"</p>")})).join("")})).join("").replace(/<p><\/p>/g,""),o(r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[]),Object(M.jsx)("div",{ref:(t=function(t){Q(t),function(t){var e,n=Object(d.a)(t.querySelectorAll("a"));try{for(n.s();!(e=n.n()).done;){var r=e.value,a=r.getAttribute("href");(null===a||void 0===a?void 0:a.startsWith("/"))&&r.setAttribute("href","/substitute-variations"+a)}}catch(c){n.e(c)}finally{n.f()}}(t),function(t,e){t.addEventListener("click",(function(t){var n=t.target,r=n.getAttribute("href");"A"===n.nodeName&&r?(t.preventDefault(),r.startsWith("http")&&!r.startsWith(window.location.origin)?window.open(r,"_blank","noopener noreferrer"):e.push(r.slice("/substitute-variations".length))):n.classList.contains("anchored")&&(window.location.hash=n.id,n.scrollIntoView(!0))}))}(t,s),function(t){window.location.hash&&setTimeout((function(){var e=j(window.location.hash.slice(1),decodeURIComponent,CSS.escape,(function(e){return t.querySelector("#".concat(e))}));null===e||void 0===e||e.scrollIntoView(!0)}),100)}(t)},function(e){if(e){var n=new MutationObserver((function(r){t(e),n.disconnect()}));n.observe(e,{childList:!0})}}),dangerouslySetInnerHTML:{__html:r}})},et=function(){return Object(M.jsxs)(U.c,{children:[Object(M.jsx)(U.a,{exact:!0,path:"/",children:Object(M.jsx)(T,{})}),Object(M.jsx)(U.a,{path:"/convert",children:Object(M.jsx)(G,{})}),Object(M.jsx)(U.a,{path:"/instructions",children:Object(M.jsx)(tt,{})})]})},nt=function(){return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(u.a,{basename:"/substitute-variations",children:[Object(M.jsxs)("nav",{className:"tabs",children:[Object(M.jsx)(u.b,{exact:!0,activeClassName:"active",to:"/",children:"Preview"}),Object(M.jsx)(u.b,{activeClassName:"active",to:"/convert",children:"Convert"}),Object(M.jsx)(u.b,{activeClassName:"active",to:"/instructions",children:"Instructions"})]}),Object(M.jsx)("main",{className:"container",children:Object(M.jsx)(et,{})})]})})},rt=n(33);fetch(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return rt.join.apply(void 0,["/substitute-variations"].concat(Object(p.a)(e.flat())))}("build-timestamp.txt")).then(function(){var t=Object(c.a)(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.text();case 2:n=t.sent,console.info("App last built",new Date(Number(n)));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),l.a.render(Object(M.jsx)(o.a.StrictMode,{children:Object(M.jsx)(nt,{})}),document.getElementById("root"))}},[[61,1,2]]]);
//# sourceMappingURL=main.f6db1819.chunk.js.map