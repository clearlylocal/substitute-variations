(this["webpackJsonpsubstitute-variations"]=this["webpackJsonpsubstitute-variations"]||[]).push([[0],{43:function(t,e,n){},63:function(t,e,n){"use strict";n.r(e);var r=n(3),a=n.n(r),c=n(8),i=n(0),o=n.n(i),s=n(30),l=n.n(s),u=(n(42),n(43),n(15)),f=n(6),d=n(7),j=n(2);function p(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.reduce((function(t,e){return e(t)}),t)}var b,h,v,O,m,x,w,g,y,S,C=function(t){return t.trim().split("\n").map((function(t){return t.trim()}))},N=function(t){return t.join("").replace(/ +/g," ").replace(/ ([.,?!;:])/g,"$1").trim()},k=/\[([^\]]+)\]/,R=function(t){return Object(j.a)(new Set(t))},I=function(t){var e=t.split(k).reduce((function(t,e,n){return n%2===0?t.map((function(t){return[].concat(Object(j.a)(t),[e])})):p(t,(r=e.split("/"),function(t){return r.flatMap((function(e){return t.map((function(t){return[].concat(Object(j.a)(t),[e])}))}))}));var r}),[[""]]).map(N);return R(e)},A=function(t){return C(t).flatMap((function(t){return R(I(t))}))},E=function(t){var e,n=C(t).map((function(t){return t.split(k).map((function(t,e){return e%2?t.split("/"):t}))})),r=[],a=Object(d.a)(n);try{var c=function(){var t=e.value,n=Math.max.apply(Math,[1].concat(Object(j.a)(t.filter((function(t,e){return e%2})).map((function(t){return t.length})))));r.push(Object(j.a)(new Array(n)).map((function(t,e){return e})).map((function(e){return t.map((function(t,n){return n%2?t[e%t.length]:t}))})).map(N))};for(a.s();!(e=a.n()).done;)c()}catch(i){a.e(i)}finally{a.f()}return R(r.flat())},L=n(31),M=function(t){for(var e=function(t,e){var n=new URL(window.location.href);return n.searchParams.delete(e),delete t[e],window.history.replaceState({},document.title,n.href),!0},n=new Proxy(Object.setPrototypeOf(Object(L.a)({},t),null),{get:function(t,e){if(e in t)return t[e];var n=new URL(window.location.href).searchParams.get(e);return null==n?void 0:JSON.parse(n)},set:function(t,n,r){var a=new URL(window.location.href);return"undefined"===typeof r?e(t,n):(a.searchParams.set(n,JSON.stringify(r)),t[n]=r,window.history.replaceState({},document.title,a.href),!0)},deleteProperty:e}),r=0,a=Object.entries(null!==t&&void 0!==t?t:{});r<a.length;r++){var c=Object(f.a)(a[r],2),i=c[0],o=c[1];n[i]=o}return n}(),P=n(1),T="[Turn on/Switch on/Enable/Activate] [the/] driver['s seat/] fan [mode/].\n[Turn/Switch] [the/] driver['s seat/] fan on.",U=function(){var t,e,n=Object(i.useState)(null!==(t=null!==(e=M.input)&&void 0!==e?e:localStorage.previewInput)&&void 0!==t?t:T),r=Object(f.a)(n,2),a=r[0],c=r[1];Object(i.useEffect)((function(){a===T?(delete M.input,delete localStorage.previewInput):M.input=localStorage.previewInput=a}),[a]);var o=Object(i.useMemo)((function(){return[A(a),E(a)].map((function(t){return t.join("\n")}))}),[a]),s=Object(f.a)(o,2),l=s[0],u=s[1];return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("h1",{children:"Preview"}),Object(P.jsx)("textarea",{className:"spaced",rows:5,cols:70,value:a,onChange:function(t){var e=t.currentTarget.value;c(e)}}),Object(P.jsx)("button",{className:"button primary",onClick:function(){window.confirm("Reset input to default example?")&&c(T)},children:"Reset"})]}),Object(P.jsxs)("div",{children:[Object(P.jsx)("h2",{children:"Sample variations"}),Object(P.jsx)("div",{className:"pre-wrap",children:u})]}),Object(P.jsxs)("div",{children:[Object(P.jsx)("h2",{children:"Full list"}),Object(P.jsx)("div",{className:"pre-wrap",children:l})]})]})},F=n(4),J=n(32),W=n(33),B=n.n(W),_=n(13),$=n(12),q=function(){var t=Object($.regex)(b||(b=Object(_.a)(["\n\t\t[^\n\t\t\t:\\/?*[]    # disallowed\n\t\t\t\0-\x1f\x7f # control chars\n\t\t\t'!:,          # delimiters\n\t\t]\n\t"],["\n\t\t[^\n\t\t\t:\\\\/?*\\[\\]    # disallowed\n\t\t\t\\x00-\\x1f\\x7f # control chars\n\t\t\t'!:,          # delimiters\n\t\t]\n\t"]))),e=Object($.regex)(h||(h=Object(_.a)(["'","+'"])),t),n=Object($.regex)(v||(v=Object(_.a)(["\n\t\t","+\n\t\t| ","\n\t"])),t,e),r=Object($.regex)(O||(O=Object(_.a)(["[a-zA-Z]+"]))),a=Object($.regex)(m||(m=Object(_.a)(["d+"],["\\d+"]))),c=Object($.regex)(x||(x=Object(_.a)(["\n\t\t(?:",")\n\t\t(?:",")\n\t"])),r,a),i=Object($.regex)(w||(w=Object(_.a)(["\n\t\t^\n\t\t\t(?<col>",")\n\t\t\t(?<row>",")?\n\t\t$\n\t"])),r,a),o=Object($.regex)(g||(g=Object(_.a)(["\n\t\t^\n\t\t\t(?:",":",")\n\t\t\t| (?:",":",")\n\t\t$\n\t"])),c,c,r,r);return{cellRefStandalone:i,rangeRefStandalone:Object($.regex)(y||(y=Object(_.a)(["\n\t\t(?:\n\t\t\t(?<sheet>",")\n\t\t\t!\n\t\t)?\n\t\t(?<cells>\n\t\t\t","\n\t\t)\n\t"])),n,Object($.unwrap)(o)),rangeRefCellsOnly:o,escapedSheetRef:e}}(),D=function(t){var e,n,r=null!==(e=null===(n=t.match(q.cellRefStandalone))||void 0===n?void 0:n.groups)&&void 0!==e?e:{},a=r.col,c=r.row;if(!a)throw new Error("Invalid cell reference");return[a,c?Number(c):-1]},V=function(t,e){if(!q.rangeRefCellsOnly.test(e))throw new Error("Invalid range");var n=e.split(":",2),r=Object(f.a)(n,2),a=[r[0],r[1]].map(D),c=Object(f.a)(a,2),i=Object(f.a)(c[0],2),o=i[0],s=i[1],l=Object(f.a)(c[1],2),u=l[0],d=l[1];if(s*d<0)throw new Error("Invalid range");var j=t.getColumn(u),p=t.getColumn(o);if(!j)throw new Error("End column not found");if(!p)throw new Error("Start column not found");var b=j.number,h=p.number,v=[];if(-1===s)for(var O=h;O<=b;O++)t.getColumn(O).eachCell((function(t,e){var n,r;null!==(r=v[n=e-1])&&void 0!==r||(v[n]=[]),v[e-1].push(t)}));else for(var m=s;m<=d;m++){var x=t.getRow(m);v.push([]);for(var w=h;w<=b;w++)v[v.length-1].push(x.getCell(w))}return v},X=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:",",r=[];return e.split(n).map((function(t){return t.trim()})).forEach((function(e){var n,a,c=null!==(n=null===(a=e.match(q.rangeRefStandalone))||void 0===a?void 0:a.groups)&&void 0!==n?n:{},i=c.sheet,o=c.cells;if(i){var s=t.getWorksheet(q.escapedSheetRef.test(i)?i.slice(1,-1):i);s&&r.push(V(s,o))}else t.eachSheet((function(t){return r.push(V(t,o))}))})),r},Z=function(t){return new Promise((function(e){var n=new FileReader;n.onload=function(t){return e(t.target.result)},n.readAsArrayBuffer(t)}))},z=function(t,e,n){var r=new Blob([e],{type:n}),a=document.createElement("a");a.href=window.URL.createObjectURL(r);var c=t;a.download=c,a.click()},H=["full","samples"],G={expansionType:"full",ranges:"*"},K=function(){var t=Object(i.useMemo)((function(){var t;return null!==(t=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.reduce((function(t,e){return null==t?t:e(t)}),t)}(localStorage.getItem("convertForm"),JSON.parse))&&void 0!==t?t:G}),[]),e=Object(J.a)({defaultValues:t}),n=e.register,r=e.handleSubmit,o=Object(i.useCallback)((function(t){localStorage.setItem("convertForm",JSON.stringify(t,(function(t,e){return"files"===t?void 0:e})))}),[]),s=Object(i.useCallback)(function(){var t=Object(c.a)(a.a.mark((function t(e){var n,r,c,i,o,s,l,u,f,j,p,b;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.files,r=e.expansionType,c="samples"===r?E:A,null===n||void 0===n?void 0:n.length){t.next=5;break}return window.alert("No file selected"),t.abrupt("return");case 5:return i=n[0],t.next=8,Z(i);case 8:return o=t.sent,s=new B.a.Workbook,t.next=12,s.xlsx.load(o);case 12:if("*"!==(l=e.ranges.trim())){t.next=17;break}s.eachSheet((function(t){t.eachRow((function(t){t.eachCell((function(t){"string"===typeof t.value&&(t.value=c(t.value).join("\n"))}))}))})),t.next=27;break;case 17:t.prev=17,u=Object(d.a)(X(s,l,/[,\n]/).flat(2));try{for(u.s();!(f=u.n()).done;)"string"===typeof(j=f.value).value&&(j.value=c(j.value).join("\n"))}catch(h){u.e(h)}finally{u.f()}t.next=27;break;case 22:return t.prev=22,t.t0=t.catch(17),window.alert("Invalid ranges"),console.error(t.t0),t.abrupt("return");case 27:return t.next=29,s.xlsx.writeBuffer();case 29:p=t.sent,b=["".concat(i.name.split(".").slice(0,-1).join(".")),"expanded",r,(a=new Date,a.toISOString().replace(/:/g,"_").slice(0,19)+"Z")].join("_"),z("".concat(b,".xlsx"),p,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");case 32:case"end":return t.stop()}var a}),t,null,[[17,22]])})));return function(e){return t.apply(this,arguments)}}(),[]);return Object(P.jsxs)("form",{onSubmit:r(s),onChange:r(o),children:[Object(P.jsx)("h1",{children:"Convert"}),Object(P.jsx)("div",{className:"spaced",children:Object(P.jsxs)("label",{children:["Upload file (XLSX)",Object(P.jsx)("input",{type:"file",name:"files",ref:n})]})}),Object(P.jsx)("div",{className:"spaced",children:Object(P.jsxs)("label",{children:["Expansion type",Object(P.jsx)("select",{name:"expansionType",ref:n,children:H.map((function(t){return Object(P.jsx)("option",{value:t,children:t},t)}))})]})}),Object(P.jsx)("div",{className:"spaced",children:Object(P.jsxs)("label",{children:["Ranges to include (* = all; comma/newline delimited)",Object(P.jsx)("textarea",{name:"ranges",ref:n})]})}),Object(P.jsx)("div",{className:"spaced",children:Object(P.jsx)("button",{type:"submit",children:"Convert"})})]})},Q=n.p+"static/media/instructions.91848c3b.md",Y=function(t){var e,n,r=(e=0,new Proxy(Object.create(null),{get:function(t,n){return n in t?t[n]:e}})),a=Object(d.a)(t.querySelectorAll("h2, h3, h4, h5, h6, .anchored"));try{for(a.s();!(n=a.n()).done;){var c=n.value;if(c.textContent){var i=c.textContent.toLowerCase().replace(Object($.regex)("gu")(S||(S=Object(_.a)(["[\n\t\t\t\t^\n\t\t\t\tp{Letter}\n\t\t\t\tp{Mark}\n\t\t\t\tp{Number}\n\t\t\t]+"],["[\n\t\t\t\t^\n\t\t\t\t\\p{Letter}\n\t\t\t\t\\p{Mark}\n\t\t\t\t\\p{Number}\n\t\t\t]+"])))," ").trim().replace(/\s+/g,"-")||"heading",o=++r[i];c.id=[i,o>1&&o].filter(Boolean).join("-"),c.classList.add("anchored")}}}catch(s){a.e(s)}finally{a.f()}},tt=n(23),et=function(){var t,e=Object(i.useState)(""),n=Object(f.a)(e,2),r=n[0],o=n[1],s=Object(F.f)();return Object(i.useEffect)((function(){fetch(Q,{cache:"force-cache"}).then(function(){var t=Object(c.a)(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.text();case 2:n=t.sent,r=n.split(/((?<=^|\n)```\r?\n[\s\S]*?\r?\n```)/).map((function(t,e){return e%2?"<pre><code>".concat(t.split(/\r?\n/).slice(1,-1).join("\n"),"</pre></code>"):t.split(/(?:\r?\n){2,}/).map((function(t){return[" ","\t","#","-","*","`","~"].some((function(e){return t.startsWith(e)}))?/^\s*-{3,}\s*$/.test(t)?"<hr>":Object(tt.a)(t):"<p>".concat(Object(tt.a)(t),"</p>")})).join("")})).join("").replace(/<p><\/p>/g,""),o(r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[]),Object(P.jsx)("div",{ref:(t=function(t){Y(t),function(t){var e,n=Object(d.a)(t.querySelectorAll("a"));try{for(n.s();!(e=n.n()).done;){var r=e.value,a=r.getAttribute("href");(null===a||void 0===a?void 0:a.startsWith("/"))&&r.setAttribute("href","/substitute-variations"+a)}}catch(c){n.e(c)}finally{n.f()}}(t),function(t,e){t.addEventListener("click",(function(t){var n=t.target,r=n.getAttribute("href");"A"===n.nodeName&&r?(t.preventDefault(),r.startsWith("http")&&!r.startsWith(window.location.origin)?window.open(r,"_blank","noopener noreferrer"):e.push(r.slice("/substitute-variations".length))):n.classList.contains("anchored")&&(window.location.hash=n.id,n.scrollIntoView(!0))}))}(t,s),function(t){window.location.hash&&setTimeout((function(){var e=p(window.location.hash.slice(1),decodeURIComponent,CSS.escape,(function(e){return t.querySelector("#".concat(e))}));null===e||void 0===e||e.scrollIntoView(!0)}),100)}(t)},function(e){if(e){var n=new MutationObserver((function(r){t(e),n.disconnect()}));n.observe(e,{childList:!0})}}),dangerouslySetInnerHTML:{__html:r}})},nt=function(){return Object(P.jsxs)(F.c,{children:[Object(P.jsx)(F.a,{exact:!0,path:"/",children:Object(P.jsx)(U,{})}),Object(P.jsx)(F.a,{path:"/convert",children:Object(P.jsx)(K,{})}),Object(P.jsx)(F.a,{path:"/instructions",children:Object(P.jsx)(et,{})})]})},rt=function(){return Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)(u.a,{basename:"/substitute-variations",children:[Object(P.jsxs)("nav",{className:"tabs",children:[Object(P.jsx)(u.b,{exact:!0,activeClassName:"active",to:"/",children:"Preview"}),Object(P.jsx)(u.b,{activeClassName:"active",to:"/convert",children:"Convert"}),Object(P.jsx)(u.b,{activeClassName:"active",to:"/instructions",children:"Instructions"})]}),Object(P.jsx)("main",{className:"container",children:Object(P.jsx)(nt,{})})]})})},at=n(36);fetch(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return at.join.apply(void 0,["/substitute-variations"].concat(Object(j.a)(e.flat())))}("build-timestamp.txt")).then(function(){var t=Object(c.a)(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.text();case 2:n=t.sent,console.info("App last built",new Date(Number(n)));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),l.a.render(Object(P.jsx)(o.a.StrictMode,{children:Object(P.jsx)(rt,{})}),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.a2db2d0d.chunk.js.map